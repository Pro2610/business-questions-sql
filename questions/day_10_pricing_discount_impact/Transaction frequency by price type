WITH user_activity AS (
  SELECT
    user_id,
    price_type,
    COUNT(*) AS transactions
  FROM classified_payments
  GROUP BY 1,2
)
SELECT
  price_type,
  AVG(transactions) AS avg_transactions_per_user
FROM user_activity
GROUP BY 1;
