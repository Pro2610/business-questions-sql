## ðŸ›  SQL (BigQuery)

### 1) Monthly ARPPU baseline
```sql
SELECT
  FORMAT_DATE('%Y-%m', DATE(payment_date)) AS month,
  SAFE_DIVIDE(
    SUM(revenue_amount),
    COUNT(DISTINCT user_id)
  ) AS arppu
FROM `project.dataset.payments`
GROUP BY 1
ORDER BY month;

SELECT
  location,
  software_name,
  `User Type` AS user_type,
  SAFE_DIVIDE(
    SUM(revenue_amount),
    COUNT(DISTINCT user_id)
  ) AS arppu,
  COUNT(DISTINCT user_id) AS paid_users
FROM `project.dataset.payments`
GROUP BY 1,2,3
HAVING paid_users >= 50
ORDER BY arppu DESC;
